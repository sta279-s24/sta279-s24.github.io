---
title: "Homework 3 Solutions"
format: 
  html:
    embed-resources: true
editor: source
author: "Ciaran Evans"
---

Total: 26 pts

#### Question 1 (3 pts)

```{r}
huber <- function(x){
  return(ifelse(abs(x) <= 1, x^2, 2*abs(x) - 1))
}
```

**Grading:** 

* 1 pt for checking the correct condition ($|x| \leq 1$)
* 1 pt for returning $x^2$ if $|x| \leq 1$
* 1 pt for returning $2|x| - 1$ if $|x| > 1$
* Note: the function does not technically have to be vectorized for question 1, but it *will* need to be vectorized for question 2

#### Question 2 (2 pts)

```{r}
huber(c(0.5, 1, 2))
```

**Grading:** 2 pts if they get the correct answer. Otherwise no points.

#### Question 3 (3 pts)

```{r}
huber <- function(x, a=1){
  return(ifelse(abs(x) <= a, x^2, 2*a*abs(x) - a^2))
}
```

**Grading:** 

* 1 pt for updating the condition to be $|x| \leq a$
* 1 pt for including `a` as an argument for the function
* 1 pt for setting `a=1` as the default

#### Question 4 (3 pts)

```{r}
relu <- function(x){
  return(ifelse(x > 0, x, 0))
}

relu(c(-1, 1))
```

**Grading:** 

* 1 pt for correctly defining a function
* 1 pt for the correct logical statement
* 1 pt for vectorizing the function

#### Question 5 (3 pts)

```{r}
leaky_relu <- function(x, a=0){
  return(ifelse(x > 0, x, a*x))
}
```

**Grading:** 

* 1 pt for correctly adapting the logical statement
* 1 pt for including `a` as an argument
* 1 pt for making `a=0` the default


#### Question 6 (6 pts)

```{r}
test_power <- function(n, nsim, beta0, beta1, alpha){
  
  pvals <- rep(NA, nsim)
  
  for(i in 1:nsim){
    x <- runif(n, min=0, max=1)
    noise <- rnorm(n, mean=0, sd=1)
    y <- beta0 + beta1*x + noise
    
    lm_mod <- lm(y ~ x)
    pvals[i] <- summary(lm_mod)$coefficients[2,4]
  }
  
  return(mean(pvals < alpha))
}
```

**Grading:** 

* 2 pts for the correct arguments (no defaults are required)
* 2 pts for using a loop inside the function to calculate power
* 1 pt for correctly calculating the p-value at each iteration
* 1 pt for returning the fraction of p-values less than the threshold


#### Question 7 (3 pts)

```{r}
test_power(100, 1000, 0, 0, 0.05)
test_power(100, 1000, 0, -1, 0.05)
test_power(100, 1000, 0, -0.5, 0.05)
test_power(100, 1000, 0, 0.5, 0.05)
test_power(100, 1000, 0, 1, 0.05)
```

Holding other simulation settings fixed, power increases as $\beta_1$ moves further away from 0, because the difference between the null and alternative hypotheses is larger.

**Grading:** 2 pts for calculating the powers, 1 pt for interpretation

#### Question 8 (3 pts)

```{r}
test_power(10, 1000, 0, 0.5, 0.05)
test_power(50, 1000, 0, 0.5, 0.05)
test_power(100, 1000, 0, 0.5, 0.05)
test_power(500, 1000, 0, 0.5, 0.05)
```

Power increases as sample size increases, because there is less variability in our estimation of $\beta_1$.

**Grading:** 2 pts for calculating the powers, 1 pt for interpretation