---
title: "Homework 8 solutions"
format: 
  html:
    embed-resources: true
editor: source
author: "Ciaran Evans"
---

1.

```{r, message=F, warning=F}
library(rvest)
library(tidyverse)

read_html("https://en.wikipedia.org/wiki/The_Great_British_Bake_Off_(series_2)") |>
  html_elements(".mw-headline[id^='Episode_']") |>
  html_text2() 
```

2.

```{r}
episodes <- read_html("https://en.wikipedia.org/wiki/The_Great_British_Bake_Off_(series_2)") |>
  html_elements(".mw-headline[id^='Episode_']") |>
  html_text2() 

data.frame(episode = episodes) |>
  separate_wider_regex(episode, patterns = c(".+ ", episode = "\\d+", ": ", 
                                          episode_name = ".+", "\\("),
                       too_few = "align_start")
```

3.

```{r}
episodes <- read_html("https://en.wikipedia.org/wiki/The_Great_British_Bake_Off_(series_4)") |>
  html_elements(".mw-headline[id^='Episode_']") |>
  html_text2() 

data.frame(episode = episodes) |>
  separate_wider_regex(episode, patterns = c(".+ ", episode = "\\d+", ": ", 
                                          episode_name = ".+", "\\("),
                       too_few = "align_start")
```

There are several extra episodes which shouldn't be there, and which don't appear to have names. This is because of several "masterclass" episodes on that wikipedia page, which weren't part of the main show.

```{r}
episodes <- read_html("https://en.wikipedia.org/wiki/The_Great_British_Bake_Off_(series_4)") |>
  html_elements(".mw-headline[id^='Episode_']") |>
  html_text2() 

data.frame(episode = episodes) |>
  filter(str_detect(episode, ":")) |>
  separate_wider_regex(episode, patterns = c(".+ ", episode = "\\d+", ": ", 
                                          episode_name = ".+", "\\s+\\("),
                       too_few = "align_start")
```

5.

```{r, message=F, warning=F}
library(data.table)

episode_list <- list()
urls <- paste0("https://en.wikipedia.org/wiki/The_Great_British_Bake_Off_(series_", 
               2:13, ")")

for(i in 2:13){
  episodes <- read_html(urls[i-1]) |>
    html_elements(".mw-headline[id^='Episode_']") |>
    html_text2() 

  episode_list[[i-1]] <- data.frame(episode = episodes) |> 
    filter(str_detect(episode, ":")) |>
    separate_wider_regex(episode, patterns = c(".+ ", episode = "\\d+", ": ", 
                                          episode_name = ".+", "\\s+\\("),
                       too_few = "align_start") |>
    mutate(series = i)
}

episodes <- rbindlist(episode_list)
head(episodes)
```

6.

```{r}
episodes |>
  count(episode_name) |>
  filter(n == 1) |>
  nrow()
```

7.

```{r}
episodes |>
  count(episode_name, sort=T)
```


